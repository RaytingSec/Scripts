#! /bin/sh/
# Debian first boot setup script. Fill in version numbers before use.
#
# Installs the following packages
# Utilities:
#   nmap, tree, vim, cpufrequtils, gparted, hydra
# Other software:
#   sublime, dropbox, qbittorrent, VMware, firefox
# Debian drivers:
#   firmware-iwlwifi
# Java:
#   icedtea-7-plugin
# Programming:
#   openjdk-7-jdk, IntelliJ, Android Studio

# Static variables
SERVER_URL=raydarnet.info.tm
SERVER_PORT=22
SERVER_USER=null # Assumed that server user has same name
BACKUP_DIR=~/backup/firstboot/

# Methods
# Update
function Update
{

    printf "\nUpdating...\n"
    sleep 3

	# Update and notify only if errors occur
	sudo apt-get update -qq
	# Upgrade and automatically accept
	sudo apt-get upgrade -qq -y
}

# Debian Drivers
function DebDrivers
{
    printf "\nInstall Debian drivers\n"
    sleep 3
    
    # Backup sources
    cp /etc/apt/sources.list $BACKUP_DIR
    
    # Add repos
    echo "
    deb http://ftp.de.debian.org/debian/ jessie main non-free contrib
	# deb-src http://ftp.de.debian.org/debian/ jessie main non-free contrib

	deb http://security.debian.org/ jessie/updates main contrib non-free
	# deb-src http://security.debian.org/ jessie/updates main contrib non-free
	" >> /etc/apt/sources.list
    
    # apt-get operations
    Update
    
    printf "\nInstalling driver...\n"
    sleep 3
    sudo apt-get firmware-iwlwifi firmware-realtek
}

###################
printf "\nCreating dirs and retreiving files\n"
sleep 3

# Create dirs
mkdir ~/backup
# bin created automatically from scp
#mkdir ~/bin

# Retrieve files for bin
scp $SERVER_URL:bin ~/ -r -p $SERVER_PORT

#GetFiles

###################
printf "\nAdding new repos\n"
sleep 3

# Sublime repo
sudo add-apt-repository ppa:webupd8team/sublime-text-3
sudo apt-add-repository "deb http://linux.dropbox.com/ubuntu $(lsb_release -cs) main"

# Update and upgrade apt-get
Update
# Could call update script
#bash ~/bin/update

###################
printf "\nCreating dirs and retreiving files\n"
sleep 3

# Proceed to packages
sudo apt-get install nmap tree vim cpufrequtils gparted hydra
sudo apt-get install sublime-text nautilus-dropbox qbittorrent

# Install VMware
# Fill in version number before use
sudo sh VMware-Workstation-xxxxx-xxxxx.x86_64.bundle

# Firefox
echo "# Firefox
deb http://packages.linuxmint.com debian import
" >> /etc/apt/sources.list
# GPG Key
sudo gpg --keyserver pgp.mit.edu --recv-keys 3EE67F3D0FF405B2
sudo gpg --export 3EE67F3D0FF405B2 > 3EE67F3D0FF405B2.gpg
sudo apt-key add ./3EE67F3D0FF405B2.gpg
sudo rm ./3EE67F3D0FF405B2.gpg
# Get Firefox
apt-get update
apt-get install firefox
apt-get install firefox-l10n-en-us 

# Java
sudo apt-get install icedtea-7-plugin

# Programming
# OpenJDK
sudo apt-get install openjdk-7-jdk
# Get remote files
scp $SERVER_URL:/someDirectory/ ~/ -r -p $SERVER_PORT
# Extract intellij, android-studio, fill in version number before use
tar -xzf ~/idealC-xxxxx.tar.gz
tar -xzf ~/android-studio-ide-xxxxx-linux.zip

###################
# Install drivers for Debian systems
DebDrivers

